#                                Assignment 2

​                                                                         **Due June 19, 11:59 pm**

 

## 1    Assignment

### 1.1

用 A* 搜索算法求解初始状态 (左边) 和目标状态 (右边) 如下图所示的 15 数码问题，写出算法过程。

（ 写前5个和最后5个完整矩阵，中间的过程略写）

![image-20220612233438762](C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220612233438762.png) 

Fig. 1: 15 数码问题

 **解：**

h(x)使用曼哈顿距离，f(x) = g(x)+h(x)

move: 0  g(x): 0  h(x): 14  f(x): 14
5  1  2  4  
9  6  3  8  
13 15 10 11 
14  0  7  12 

move: 1  g(x): 1  h(x): 13  f(x): 14
5  1  2  4  
9  6  3  8  
13 0  10 11 
14 15 7  12 

move: 2  g(x): 2  h(x): 12  f(x): 14
5  1  2  4  
9  6  3  8  
13 10 0  11 
14 15 7  12 

move: 3  g(x): 3  h(x): 11  f(x): 14
5  1  2  4  
9  6  3  8  
13 10 7  11 
14 15 0  12 

move: 4  g(x): 4  h(x): 10  f(x): 14
5  1  2  4  
9  6  3  8  
13 10 7  11 
14 0  15 12 

move: 5  g(x): 5  h(x): 9  f(x): 14
5  1  2  4  
9  6  3  8  
13 10 7  11 
0  14 15 12

...

move: 10  g(x): 10  h(x): 4  f(x): 14
1  2  0  4  
5  6  3  8  
9  10 7  11 
13 14 15 12 

move: 11  g(x): 11  h(x): 3  f(x): 14
1  2  3  4  
5  6  0  8  
9  10 7  11 
13 14 15 12 

move: 12  g(x): 12  h(x): 2  f(x): 14
1  2  3  4  
5  6  7  8  
9  10 0  11 
13 14 15 12 

move: 13  g(x): 13  h(x): 1  f(x): 14
1  2  3  4  
5  6  7  8  
9  10 11 0  
13 14 15 12 

move: 14  g(x): 14  h(x): 0  f(x): 14
1  2  3  4  
5  6  7  8  
9  10 11 12 
13 14 15 0  

 

### 1.2

在下图所示的博弈树中，进行 *α* *−* *β* 剪枝搜索，写出算法过程。

 ![image-20220609095646048](C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220609095646048.png)

Fig. 2: 博弈树

 **解：**

第0步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172341976.png" alt="image-20220619172341976" style="zoom:57%;" /> 

第1步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172458052.png" alt="image-20220619172458052" style="zoom:60%;" /> 

第2步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172536134.png" alt="image-20220619172536134" style="zoom:63%;" /> 

第3步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172618651.png" alt="image-20220619172618651" style="zoom:60%;" /> 

第4步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172727377.png" alt="image-20220619172727377" style="zoom:60%;" /> 

第5步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172753926.png" alt="image-20220619172753926" style="zoom:60%;" /> 

第6步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172828639.png" alt="image-20220619172828639" style="zoom:62%;" /> 

第7步：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172900900.png" alt="image-20220619172900900" style="zoom:62%;" /> 

第8步（最后一步）：

<img src="C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220619172926157.png" alt="image-20220619172926157" style="zoom:62%;" /> 





### 1.3

如图 3 所示多层感知机模型，第一层是输入层，包含两个神经元：x1=0.08，x2=0.12 和偏置 b1；第二层是隐藏层，包含两个神经元：h1，h2 和偏置项 b2；第三层是输出：y1，y2。每条线上标的 *wi,j* 是第 *i* 层第 *j* 个权重参数，激活函数是 sigmoid 函数（h 神经元之后），Loss 函数使用 MSE（均方误差）函数，真实标签 *Label*1 = 0*.*05*,* *Label*2 = 0*.*95，学习率 *α* = 0*.*5，求在经过一次反向传播后所有权重参数的值（写出计算过程）。

![image-20220609095716545](C:\Users\zhong'h'c\AppData\Roaming\Typora\typora-user-images\image-20220609095716545.png) 

Fig. 3: MLP

 **解：**

**前向传播：**

由输入层的结点(x1,x2)，利用权重矩阵W1计算得到(h1,h2):

h1 = w11\*x1 + w13\*x2+b1 = 0.24\*0.08+0.2\*0.12+0.28=0.3232

h2 = w12\*x1 + w14\*x2+b1 = 0.3\*0.08+0.16\*0.12+0.28=0.3232

经过激活函数sigmoid得到(a1,a2)这就得到了隐藏层的输出：

(a1,a2) = (sigmod(h1), sigmod(h2)) = (0.58，0.58)

之后，利用权重矩阵W2计算得到(β1,β2)：

β1 = w21\*a1+ w23\*a2+b2 = (0.5+0.55)*0.58+0.6 = 1.209

β2 = w22\*a1 + w24\*a2+b2 = (0.45+0.4)*0.58+0.6 = 1.093

经过激活函数sigmoid得到(y1,y2)，也就是最后的输出：

(y1,y2) = (sigmod(β1), sigmod(β2)) = (0.77, 0.75)



**反向传播：** 
$$
x = (x1,x2) = (0.08,0.12)\\
L= (Lable1,Lable2) = (0.05,0.95)\\
y = (y1,y2)=(0.77,0.75)\\
β = (β1,β2) = (1.209,1.093)\\
W2 = W2 - α*(L-y)*y*(1-y)*β \\
W1 = W1 - α*(L-y)*y*(1-y)*W2*β*(1-β)*x\\
(L-y)*y=
\left[\begin{matrix}
-0.5544& -0.54\\
0.154 &0.15
\end{matrix}\right]\\
 α(1-y)*β = 0.211\\
 (1-β)*x=-0.028
$$
则隐藏层参数更新为：

W21 = 0.5-0.211\*(-0.5544)=0.617 = 0.62

W22 = 0.45-0.211*(-0.54) = 0.564 = 0.56

w23 = 0.55 - 0.211*0.154=0.518 = 0.52

w24 = 0.4 - 0.211*0.15=0.368 = 0.37

输入层参数更新为

w11 = 0.24 - 0.211\*(-0.5544)\*(-0.028) = 0.2367 = 0.24

w12 = 0.3 - 0.211*(-0.54) \*(-0.028)=0.2968 = 0.3

w13 = 0.2 - 0.211*0.154\*(-0.028)=0.2009 = 0.2

w14 = 0.16 -0.211*0.15\*(-0.028) = 0.1609 = 0.16



## 2    Submission

提交一份 PDF 文件，命名格式：学号 _ 姓名 _ 作业编号，如 20331234_ 张三 _02。提交邮箱: [zhangyc8@mail2.sysu.edu.cn](mailto:zhangyc8@mail2.sysu.edu.cn)

截止日期: 6/19/2022, 11:59 pm